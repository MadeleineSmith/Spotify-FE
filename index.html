<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Spotify</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

</head>
<body>
<form id="example-basic">


    <a href="http://localhost:6584/login" class="btn btn-primary">Log in with Spotify</a>




    <!--    Spotify Username: -->
    <input id="spotify-username" type="text" name="username" placeholder="Spotify username">


    <!--    Playlist Name:-->
    <input id="playlist-name" type="text" name="playlistName" placeholder="Playlist name">




    <label></label>
    <select name="yearpicker" id="yearpicker"></select>




    <input type="submit" value="Submit">
</form>


<script>
    $(document).ready(function () {
        // CONSTANTS
        const DEFAULT_USERNAME = "m"
        var date = new Date()
        const DEFAULT_PLAYLIST_NAME = date.toTimeString()


        // YEARPICKER
        // TODO Change as actually goes back to 1952
        // Won't work on current year
        for (i = new Date().getFullYear(); i > 1953; i--)
        {
            $('#yearpicker').append($('<option />').val(i).html(i));
        }


        $('#example-basic').on('submit', function (e) {
            e.preventDefault();


            $.get("http://localhost:6584/login")


            // var username = $("#spotify-username").val();
            //
            // // TODO - take out - testing purposes only
            // if (username === "") {
            //     // user ID of my test account
            //     username = "d51f6n8p9082ggnmbv9mxcusu"
            // }
            //
            // var createPlaylistURL = `http://localhost:6584/users/${username}/playlists`;
            //
            // var playlistName = $("#playlist-name").val();
            //
            // // TODO - take out - testing purposes only
            // if (playlistName === "") {
            //     playlistName = DEFAULT_PLAYLIST_NAME
            // }
            //
            // $.post(createPlaylistURL, {name: playlistName})
            //     .done(function (playlist) {
            //         var playlistID = playlist.id
            //
            //         var year = $('#yearpicker').val()
            //
            //         var scrapeOfficialChartsURL = `http://localhost:6584/charts/${year}`
            //
            //         $.get(scrapeOfficialChartsURL)
            //             .done(function (scrapedData) {
            //
            //                 var spotifySearchURL = `http://localhost:6584/search`
            //                 $.post(spotifySearchURL, JSON.stringify(scrapedData))
            //                     .done(function (completedData) {
            //
            //                         var addToPlaylistURL = `http://localhost:6584/playlists/${playlistID}/tracks`
            //
            //                         $.post(addToPlaylistURL, JSON.stringify(completedData))
            //                             .done(function (evenMoreData) {
            //
            //                                 alert(`Playlist: ${playlistName} added to username: ${username}`)
            //
            //                             })
            //
            //                     })
            //
            //
            //             })
            //     });
        });
    });
</script>
<script src="//unpkg.com/navigo@6"></script>
</body>
</html>